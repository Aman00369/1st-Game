<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A-Man's Crazy Calculus - Enhanced Edition üß†‚ú®</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-size: 16px;
            text-align: center;
            padding: 20px;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50% }
            50% { background-position: 100% 50% }
            100% { background-position: 0% 50% }
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 30px;
            width: 100%;
            max-width: 700px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 25px;
            background: linear-gradient(45deg, #fff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        select, input, button {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 12px;
            border: none;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        select {
            background: rgba(255, 255, 255, 0.9);
            cursor: pointer;
        }

        input {
            background: rgba(255, 255, 255, 0.8);
            color: #333;
        }

        button {
            background: linear-gradient(45deg, #00b4db, #0083b0);
            color: white;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 16px;
            transition: transform 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-box:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.2);
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00b4db, #0083b0);
            transition: width 0.3s linear;
        }

        .feedback {
            margin: 20px 0;
            padding: 15px;
            border-radius: 12px;
            animation: fadeInUp 0.5s ease;
        }

        .feedback.correct {
            background: rgba(46, 213, 115, 0.2);
        }

        .feedback.wrong {
            background: rgba(255, 71, 87, 0.2);
        }

        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #333;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            animation: slideInRight 0.5s ease, slideOutRight 0.5s ease 2.5s forwards;
            z-index: 1000;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .difficulty-indicator {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 8px 15px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.2);
            font-size: 0.9rem;
        }

        @media (max-width: 600px) {
            .stats-container {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.8rem;
            }

            .container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>A-Man's Crazy Calculus - Enhanced Edition üß†‚ú®</h1>

        <select id="difficulty" onchange="resetGame()" class="animate__animated animate__fadeIn">
            <option value="beginner">Beginner</option>
            <option value="easy">Easy</option>
            <option value="moderate">Moderate</option>
            <option value="difficult">Difficult</option>
            <option value="expert">Expert</option>
            <option value="genius">Genius</option>
        </select>

        <div id="question" class="animate__animated animate__fadeIn"></div>
        <input type="number" id="answer" placeholder="Your answer here..." step="any" autofocus>
        <button onclick="checkAnswer()" class="animate__animated animate__pulse">Submit Answer üéØ</button>

        <div class="stats-container">
            <div class="stat-box">
                <div id="score">Score: 0 üèÜ</div>
            </div>
            <div class="stat-box">
                <div id="streak">Streak: 0 üî•</div>
            </div>
            <div class="stat-box">
                <div id="timer">Time: 60s ‚è≥</div>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>

        <div id="feedback" class="feedback"></div>
    </div>

    <script>
        let score = 0;
        let streak = 0;
        let timeLeft = 60;
        let currentAnswer;
        let gameInterval;
        let isPaused = false;
        let highScore = localStorage.getItem('highScore') || 0;

        const questionTypes = {
            beginner: {
                range: [1, 5],
                operations: ['add', 'subtract']
            },
            easy: {
                range: [1, 10],
                operations: ['add', 'subtract', 'multiply']
            },
            moderate: {
                range: [1, 20],
                operations: ['add', 'subtract', 'multiply', 'divide']
            },
            difficult: {
                range: [1, 50],
                operations: ['multiply', 'divide', 'power']
            },
            expert: {
                range: [1, 100],
                operations: ['power', 'root', 'log']
            },
            genius: {
                range: [1, 200],
                operations: ['power', 'root', 'log', 'factorial']
            }
        };

        function generateQuestion() {
            const difficulty = document.getElementById('difficulty').value;
            const settings = questionTypes[difficulty];
            const operation = settings.operations[Math.floor(Math.random() * settings.operations.length)];

            const num1 = Math.floor(Math.random() * (settings.range[1] - settings.range[0])) + settings.range[0];
            const num2 = Math.floor(Math.random() * (settings.range[1] - settings.range[0])) + settings.range[0];

            let question, answer;

            switch(operation) {
                case 'add':
                    question = `What is ${num1} + ${num2}?`;
                    answer = num1 + num2;
                    break;
                case 'subtract':
                    question = `What is ${num1} - ${num2}?`;
                    answer = num1 - num2;
                    break;
                case 'multiply':
                    question = `What is ${num1} √ó ${num2}?`;
                    answer = num1 * num2;
                    break;
                case 'divide':
                    answer = num1;
                    question = `What is ${num1 * num2} √∑ ${num2}?`;
                    break;
                case 'power':
                    question = `What is ${num1} to the power of 2?`;
                    answer = Math.pow(num1, 2);
                    break;
                case 'root':
                    answer = num1;
                    question = `What is the square root of ${num1 * num1}?`;
                    break;
                case 'log':
                    answer = Math.log10(num1).toFixed(2);
                    question = `What is log‚ÇÅ‚ÇÄ(${num1})? (Round to 2 decimal places)`;
                    break;
                case 'factorial':
                    const n = Math.min(num1 % 10, 5); // Limit factorial to prevent huge numbers
                    question = `What is ${n}! (factorial)?`;
                    answer = factorial(n);
                    break;
            }

            document.getElementById('question').textContent = question;
            currentAnswer = answer;
        }

        function factorial(n) {
            return (n <= 1) ? 1 : n * factorial(n - 1);
        }

        function checkAnswer() {
            const userAnswer = parseFloat(document.getElementById('answer').value);
            const feedback = document.getElementById('feedback');

            if (Math.abs(userAnswer - currentAnswer) < 0.1) {
                score += getDifficultyPoints();
                streak++;
                feedback.textContent = `Correct! üéâ +${getDifficultyPoints()} points`;
                feedback.className = 'feedback correct animate__animated animate__bounceIn';

                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('highScore', highScore);
                    showAchievement('New High Score! üèÜ');
                }
            } else {
                streak = 0;
                feedback.textContent = `Incorrect! The answer was ${currentAnswer} ‚ùå`;
                feedback.className = 'feedback wrong animate__animated animate__shakeX';
            }

            updateStats();
            document.getElementById('answer').value = '';
            generateQuestion();
        }

        function getDifficultyPoints() {
            const difficultyMultipliers = {
                beginner: 1,
                easy: 2,
                moderate: 3,
                difficult: 5,
                expert: 8,
                genius: 10
            };
            return difficultyMultipliers[document.getElementById('difficulty').value];
        }

        function updateStats() {
            document.getElementById('score').textContent = `Score: ${score} üèÜ`;
            document.getElementById('streak').textContent = `Streak: ${streak} üî•`;
            document.getElementById('timer').textContent = `Time: ${timeLeft}s ‚è≥`;
            document.getElementById('progress-fill').style.width = `${(timeLeft / 60) * 100}%`;
        }

        function showAchievement(text) {
            const achievement = document.createElement('div');
            achievement.className = 'achievement-popup';
            achievement.textContent = text;
            document.body.appendChild(achievement);
            setTimeout(() => achievement.remove(), 3000);
        }

        function startTimer() {
            clearInterval(gameInterval);
            gameInterval = setInterval(() => {
                if (!isPaused) {
                    timeLeft--;
                    updateStats();

                    if (timeLeft <= 0) {
                        clearInterval(gameInterval);
                        endGame();
                    }
                }
            }, 1000);
        }

        function endGame() {
            showAchievement(`Game Over! Final Score: ${score}`);
            setTimeout(() => {
                if (confirm(`Game Over!\nFinal Score: ${score}\nHigh Score: ${highScore}\n\nPlay again?`)) {
                    resetGame();
                }
            }, 500);
        }

        function resetGame() {
            score = 0;
            streak = 0;
            timeLeft = 60;
            isPaused = false;
            updateStats();
            generateQuestion();
            startTimer();
        }

        // Event Listeners
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && document.activeElement === document.getElementById('answer')) {
                checkAnswer();
            }
            if (e.key === 'Escape') {
                isPaused = !isPaused;
                showAchievement(isPaused ? 'Game Paused ‚è∏Ô∏è' : 'Game Resumed ‚ñ∂Ô∏è');
            }
        });

        // Initialize game
        generateQuestion();
        startTimer();
    </script>
</body>
</html>